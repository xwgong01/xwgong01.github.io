<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Enhance LHAASO Resolution with Machine Learning | Xingwei Gong </title> <meta name="author" content="Xingwei Gong"> <meta name="description" content="De-convolution with neural networks!"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>" > <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xwgong01.github.io/projects/1_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Xingwei</span> Gong </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link"> <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Enhance LHAASO Resolution with Machine Learning</h1> <p class="post-description">De-convolution with neural networks!</p> </header> <article> <p>Every instrument suffers from systematic error — As a result, imaging power is limited by point spread function (PSF). It has been proven impossible to recover the original sky map from PSF blurring using mathematical methods. Will machine learning make a difference?</p> <p>Super Resolution techniques have been widely applied in microscopy. They could go beyond the instrumental limit, help resolving the small structures of tiny structures like fibers. Inspired by this, we want to explore whether similar models could be applied in astronomical research. the Large High Altitude Air Shower Observatory (LHAASO) has measured extreme high energy gamma-ray photons, but its angular resolution is poor, many sources are unresolved. If machine learning can enhance the resolution, it could at least give some hints on the source morphology, which help researcher identify the cosmic ray acceleration site.</p> <h4 id="training-data">Training Data</h4> <div class="d-flex justify-content-center"> <div class="col-12 col-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fermibkg-480.webp 480w,/assets/img/fermibkg-800.webp 800w,/assets/img/fermibkg-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/fermibkg.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Fermi Diffuse Gamma-Ray Emission Model" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>We start from a rather simple case. We first train the model to reconstruct PSF-blurred sky map with certain energy and declination, which means the PSF of LHAASO is accurately measured. Since the LHAASO data are not well studied, we choose dataset from Fermi LAT, an earlier gamma-ray observatory, as the intrinsic intensity map. The sky map is then convolved with the LHAASO PSF. On this dataset, we tested the ability of machine learning model to reconstruct sky maps blurred with certain PSF.</p> <p>We then perform a 2d-convolution with the PSF function to the sky map, so that it looks smoothed and the small scale structure seems not distinguishable any more.</p> <div class="row"> <div class="col-3 col-md-3"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/origbkg-480.webp 480w,/assets/img/origbkg-800.webp 800w,/assets/img/origbkg-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/origbkg.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-3 col-md-3"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blurbkg-480.webp 480w,/assets/img/blurbkg-800.webp 800w,/assets/img/blurbkg-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/blurbkg.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-6 col-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/poiselect-480.webp 480w,/assets/img/poiselect-800.webp 800w,/assets/img/poiselect-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/poiselect.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Fermi Diffuse Gamma-Ray Emission Model" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The sky map is cropped into many small areas (\(6.4 \times 6.4^\circ \)) (left), blurred with PSF (mid). The sky regions are selected with fibonacci laticce (right). </div> <p>We have trained on different models, such as variational auto-encoder (VAE), convolutional neural network (CNN) and generative adversial network (GAN). It turns out that the simplest CNN has the best performance, which is due to the convolutional nature of CNN. We have applied the trained model to five LHAASO KM2A observations at 25 to 40 TeV. It turns out that the machine learning model can recover the strong poisson noise. Also, along the manually selected directions, the peak reconstructed by our model is narrower than the TS Map resulted from the traditional likelihood test.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/recon_lhaaso-480.webp 480w,/assets/img/recon_lhaaso-800.webp 800w,/assets/img/recon_lhaaso-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/recon_lhaaso.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="reconstructed LHAASO observations" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> First row from left: counts map from observation (should be affected by PSF); Second row: TS map using 0.29 degree as smooth radius; Third Row: machine learning reconstructed intensity map; Rightmost: intensity curve along manually selected direction. </div> <h3 id="problems-and-the-future">Problems and The Future</h3> <p>In the real observation, PSF varies with energy and declination, which is a challenge for training a unified model for reconstructing the all sky map. Our treatment to the PSF blurring is also too ideal.</p> <p>We gave a poster presentation recently at the Second LHAASO Collaboration Conference recently in Chengdu, Sichuan. Now we are collaborating with researchers from IHEP. They will offer guidance of simulating LHAASO observation, and make sure our training data is close to the real observation.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Xingwei Gong. Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-projects",title:"projects",description:"Research projects I've taken part in",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"post-a-post-with-jupyter-notebook",title:"a post with jupyter notebook",description:"an example of a blog post with jupyter notebook",section:"Posts",handler:()=>{window.location.href="/blog/2023/jupyter-notebook/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-enhance-lhaaso-resolution-with-machine-learning",title:"Enhance LHAASO Resolution with Machine Learning",description:"De-convolution with neural networks!",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-coincidence-search-for-icecube-alerts-clustering",title:"Coincidence Search for IceCube Alerts Clustering",description:"based on Monte-Carlo scramblings",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-stochastic-particle-acceleration-in-gamma-ray-burst",title:"Stochastic Particle Acceleration in Gamma-Ray Burst",description:"A second relativistic particle component in GRB afterglow: Insights from LHAASO's observation on GRB 221009A",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%32%30%31%38%34%30%33%31%39@%73%6D%61%69%6C.%6E%6A%75.%65%64%75.%63%6E","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>